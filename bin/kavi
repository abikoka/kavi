#!/bin/sh

TICKETNO_OR_NAME_OR_COMMAND=$1
if [ ! "$TICKETNO_OR_NAME_OR_COMMAND" ]; then
  echo "usage: "
  echo "    print edit file name list: $ kavi list "
  echo "    edit sources   : $ kavi hoge "
  echo "    edit file list : $ kavi hoge edit "
  exit 1
fi

COMMAND=$2

BASE_DIRECTORY=$HOME/work

if [ ! -d "$BASE_DIRECTORY" ]; then
  mkdir $BASE_DIRECTORY
fi

if [ "list" = $TICKETNO_OR_NAME_OR_COMMAND ]; then
  ls -ltr $BASE_DIRECTORY/*.txt
  exit
fi

FILE="${BASE_DIRECTORY}/${TICKETNO_OR_NAME_OR_COMMAND}.txt"
if [ "edit" = "$COMMAND" ]; then
  vi $FILE
  exit
fi

if [ ! -f $FILE ]; then
  echo "${FILE} is not exists."
  exit 1
fi

if [ "cat" = "$COMMAND" ]; then
  cat $FILE
  exit
fi

if [ "file" = "$COMMAND" ]; then
  echo $FILE
  exit
fi

vi `cat $FILE | grep -v "^#"`

exit

